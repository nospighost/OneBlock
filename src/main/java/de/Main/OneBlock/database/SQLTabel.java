package de.Main.OneBlock.database;import org.bukkit.GameMode;import org.bukkit.entity.Player;import org.bukkit.event.EventHandler;import org.bukkit.event.Listener;import org.bukkit.event.player.PlayerJoinEvent;import java.sql.*;import java.util.*;public class SQLTabel implements Listener {    private final SQLConnection connection;    private final String name;    public  HashMap<String, SQLDataType> colums; //Spalten, Datentypen    public SQLTabel(SQLConnection connection, String name, HashMap<String, SQLDataType> colums) {        this.connection = connection;        this.name = name;        this.colums = colums;    }    @EventHandler(ignoreCancelled = true)    public void onPlayerJoin(PlayerJoinEvent event) {        UUID uuid = event.getPlayer().getUniqueId();        createUserTable(uuid);    }    public Set<String> getName() {        return colums.keySet();    }    public SQLDataType getType(String columname) {        return colums.get(columname);    }    public void createUserTable(UUID uuid) {        String sql = "CREATE TABLE IF NOT EXISTS `" + uuid.toString() + "` (";//erstellt eine neue Tabelle mit der uuid des users als Name, falls es sie noch nicht gibt        for (String colum : colums.keySet()) {            sql += colum + " " + colums.get(colum).toSQL() + ","; //wandelt es in SQL Sprache um        }        sql = sql.substring(0, sql.length() - 1); //letzes Komma löschen, um den Befehl zu beenden        sql += ");"; //^^        try {            Statement stateMent = this.connection.getConnection().createStatement();            stateMent.executeUpdate(sql);        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public void insert(HashMap<String, Object> values) {        if (values.isEmpty()) return;        StringBuilder cols = new StringBuilder();        StringBuilder placeholders = new StringBuilder();        for (String col : values.keySet()) {            cols.append(col).append(",");            placeholders.append("?,");        }        // Letztes Komma entfernen        cols.setLength(cols.length() - 1);        placeholders.setLength(placeholders.length() - 1);        String sql = "INSERT INTO `" + this.name + "` (" + cols + ") VALUES (" + placeholders + ")";        try {            PreparedStatement ps = connection.getConnection().prepareStatement(sql);            int index = 1;            for (String col : values.keySet()) {                ps.setObject(index++, values.get(col));            }            ps.executeUpdate();        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public static class Condition { //Zustand überprüfen ob es die Bedingung gibt        String value;        String columName;        public Condition(String columname, String value) {            this.value = value;            this.columName = columname;        }        public String getColumname() {            return columName;        }        public String getValue() {            return value;        }    }//Zustand überprüfen, ob es die Bedingung gibt    public void set(String columName, Object objects, Condition condition) {        if (objects == null) {  //Gucken, ob es die Condition gibt            remove(condition);            return;        }        if (exits(condition)) {            try {                String sql = "UPDATE `" + this.name + "` SET " + columName + "=? WHERE " + condition.columName + "=?";                PreparedStatement ps = connection.getConnection().prepareStatement(sql);                ps.setObject(1, objects);                ps.setString(2, condition.value);                ps.executeUpdate();            } catch (SQLException e) {                throw new RuntimeException(e);            }        } else {            try {                // Ursprünglich war hier INSERT zu erwarten, aber dein Code macht UPDATE nochmal (vermutlich ein Fehler)                // Korrigiere hier bitte ggf. auf INSERT mit WHERE nicht möglich                // Beispiel INSERT mit WHERE macht keinen Sinn, hier korrigiere ich es auf INSERT:                String sql = "INSERT INTO `" + this.name + "` (" + columName + ") VALUES (?)";                PreparedStatement ps = connection.getConnection().prepareStatement(sql);                ps.setObject(1, objects);                ps.executeUpdate();            } catch (SQLException e) {                throw new RuntimeException(e);            }        }    }    public void remove(Condition condition) { //von dem Table removen        try {            String sql = "DELETE FROM `" + this.name + "` WHERE " + condition.columName + "=?";            PreparedStatement ps = connection.getConnection().prepareStatement(sql); //Deleten            ps.setString(1, condition.value);//deleten            ps.executeUpdate();        } catch (SQLException e) {            throw new RuntimeException(e); //FEHLER!        }    }    private PreparedStatement select(String columName, Condition condition) {        try {            String sql = "SELECT " + columName + " FROM `" + this.name + "` WHERE " + condition.columName + "=?";            PreparedStatement ps = connection.getConnection().prepareStatement(sql);            ps.setString(1, condition.value);            ResultSet rs = ps.executeQuery();            if (rs.next()) {                return ps;            }            return null;        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public String getString(String columName, Condition condition) {        try {            ResultSet rs = select(columName, condition).executeQuery();            if (rs.next()) {                return rs.getString(columName);            }            return null;        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public int getInt(String columName, Condition condition) {        try {            ResultSet rs = select(columName, condition).executeQuery();            if (rs.next()) {                return rs.getInt(columName);            }            return 0;        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public boolean getBoolean(String columName, Condition condition) {        try {            ResultSet rs = select(columName, condition).executeQuery();            if (rs.next()) {                return rs.getBoolean(columName);            }            return false;        } catch (SQLException e) {            throw new RuntimeException(e);        }    }    public boolean exits(Condition condition) { //existiert die Bedingung?        try {            String sql = "SELECT " + condition.columName + " FROM `" + this.name + "` WHERE " + condition.columName + "=?";            PreparedStatement ps = connection.getConnection().prepareStatement(sql); //Condition aus der Datenbank Holen            ps.setString(1, condition.value);            ResultSet rs = ps.executeQuery();            return rs.next();        } catch (SQLException e) {            throw new RuntimeException(e); //FEHLER!        }    }}